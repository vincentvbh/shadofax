
#include "gandalf_samplerZ.h"
#include "randombytes.h"

#include <math.h>
#include <stddef.h>

#define GANDALF_TABLE_SIZE (1308)

uint64_t Gandalf_table[GANDALF_TABLE_SIZE] = {
45068198583791423ULL,
90355459048261646ULL,
180705835164967195ULL,
271047740364492387ULL,
361377787614207490ULL,
451692591215425109ULL,
541988767184097624ULL,
632262933631193335ULL,
722511711142679833ULL,
812731723159043798ULL,
902919596354275330ULL,
993071961014247532ULL,
1083185451414417401ULL,
1173256706196783051ULL,
1263282368746019961ULL,
1353259087564732880ULL,
1443183516647745950ULL,
1533052315855371537ULL,
1622862151285577205ULL,
1712609695644989269ULL,
1802291628618662614ULL,
1891904637238545419ULL,
1981445416250574663ULL,
2070910668480332500ULL,
2160297105197194767ULL,
2249601446476908922ULL,
2338820421562528924ULL,
2427950769223646966ULL,
2516989238113850707ULL,
2605932587126347074ULL,
2694777585747678118ULL,
2783521014409478938ULL,
2872159664838198238ULL,
2960690340402730104ULL,
3049109856459887383ULL,
3137415040697658882ULL,
3225602733476185117ULL,
3313669788166395410ULL,
3401613071486242779ULL,
3489429463834476551ULL,
3577115859621898371ULL,
3664669167600038659ULL,
3752086311187192249ULL,
3839364228791769907ULL,
3926499874132890598ULL,
4013490216558173505ULL,
4100332241358669123ULL,
4187022950080873390ULL,
4273559360835776340ULL,
4359938508604884020ULL,
4446157445543176123ULL,
4532213241278929447ULL,
4618102983210373648ULL,
4703823776799119221ULL,
4789372745860312060ULL,
4874747032849468960ULL,
4959943799145940904ULL,
5044960225332966593ULL,
5129793511474262481ULL,
5214440877387105983ULL,
5298899562911877207ULL,
5383166828178003153ULL,
5467239953866270305ULL,
5551116241467467476ULL,
5634793013537306919ULL,
5718267613947600594ULL,
5801537408133639585ULL,
5884599783337746642ULL,
5967452148848961385ULL,
6050091936238830469ULL,
6132516599593262231ULL,
6214723615740406569ULL,
6296710484474540392ULL,
6378474728775925127ULL,
6460013895026586619ULL,
6541325553222028955ULL,
6622407297178795576ULL,
6703256744737913467ULL,
6783871537964144203ULL,
6864249343341036033ULL,
6944387851961770100ULL,
7024284779715733768ULL,
7103937867470841847ULL,
7183344881251560674ULL,
7262503612412625782ULL,
7341411877808416200ULL,
7420067519957998090ULL,
7498468407205785712ULL,
7576612433877831301ULL,
7654497520433710310ULL,
7732121613614002053ULL,
7809482686583339150ULL,
7886578739069021162ULL,
7963407797495185486ULL,
8039967915112518163ULL,
8116257172123493066ULL,
8192273675803145226ULL,
8268015560615356354ULL,
8343480988324658333ULL,
8418668148103536190ULL,
8493575256635249038ULL,
8568200558212138949ULL,
8642542324829443926ULL,
8716598856274619604ULL,
8790368480212141949ULL,
8863849552263830227ULL,
8937040456084655603ULL,
9009939603434067700ULL,
9082545434242832198ULL,
9154856416675373695ULL,
9226871047187646934ULL,
9298587850580546795ULL,
9370005380048839730ULL,
9441122217225651295ULL,
9511936972222510931ULL,
9582448283664963256ULL,
9652654818723758556ULL,
9722555273141636353ULL,
9792148371255726316ULL,
9861432866015552641ULL,
9930407538996691593ULL,
9999071200410079891ULL,
10067422689106990123ULL,
10135460872579710154ULL,
10203184646957911519ULL,
10270592937000773799ULL,
10337684696084836117ULL,
10404458906187641595ULL,
10470914577867165544ULL,
10537050750237072429ULL,
10602866490937803954ULL,
10668360896103564084ULL,
10733533090325162917ULL,
10798382226608812970ULL,
10862907486330869796ULL,
10927108079188535431ULL,
10990983243146593988ULL,
11054532244380170150ULL,
11117754377213552174ULL,
11180648964055139479ULL,
11243215355328498642ULL,
11305452929399585574ULL,
11367361092500187041ULL,
11428939278647569948ULL,
11490186949560428546ULL,
11551103594571099487ULL,
11611688730534139502ULL,
11671941901731288790ULL,
11731862679772815510ULL,
11791450663495338433ULL,
11850705478856148541ULL,
11909626778824018036ULL,
11968214243266626154ULL,
12026467578834569445ULL,
12084386518842032766ULL,
12141970823144139485ULL,
12199220278011047911ULL,
12256134695998826296ULL,
12312713915817127213ULL,
12368957802193758374ULL,
12424866245736117519ULL,
12480439162789613871ULL,
12535676495293069217ULL,
12590578210631149454ULL,
12645144301483907489ULL,
12699374785673425926ULL,
12753269706007668169ULL,
12806829130121528683ULL,
12860053150315160998ULL,
12912941883389631966ULL,
12965495470479934651ULL,
13017714076885415288ULL,
13069597891897653607ULL,
13121147128625870482ULL,
13172362023819869818ULL,
13223242837690614058ULL,
13273789853728433313ULL,
13324003378518948979ULL,
13373883741556746534ULL,
13423431295056864500ULL,
13472646413764122703ULL,
13521529494760366081ULL,
13570080957269649459ULL,
13618301242461434937ULL,
13666190813251843479ULL,
13713750154103011547ULL,
13760979770820594381ULL,
13807880190349489867ULL,
13854451960567799171ULL,
13900695650079107340ULL,
13946611848003125450ULL,
13992201163764733609ULL,
14037464226881464080ULL,
14082401686749540082ULL,
14127014212428426358ULL,
14171302492424020920ULL,
14215267234470494910ULL,
14258909165310847581ULL,
14302229030476224948ULL,
14345227594064043677ULL,
14387905638514987260ULL,
14430263964388902184ULL,
14472303390139674982ULL,
14514024751889104041ULL,
14555428903199835480ULL,
14596516714847425505ULL,
14637289074591547722ULL,
14677746886946410113ULL,
14717891072950444073ULL,
14757722569935295553ULL,
14797242331294157584ULL,
14836451326249529699ULL,
14875350539620422727ULL,
14913940971589039019ULL,
14952223637467055181ULL,
14990199567461433392ULL,
15027869806439932297ULL,
15065235413696268949ULL,
15102297462715026555ULL,
15139057040936358855ULL,
15175515249520484216ULL,
15211673203112096518ULL,
15247532029604660514ULL,
15283092869904686371ULL,
15318356877695990362ULL,
15353325219204031810ULL,
15387999072960330914ULL,
15422379629567011371ULL,
15456468091461541727ULL,
15490265672681700898ULL,
15523773598630779399ULL,
15556993105843124898ULL,
15589925441749999753ULL,
15622571864445847571ULL,
15654933642454987298ULL,
15687012054498757927ULL,
15718808389263190107ULL,
15750323945167213880ULL,
15781560030131453390ULL,
15812517961347636303ULL,
15843199065048678007ULL,
15873604676279461409ULL,
15903736138668321556ULL,
15933594804199352948ULL,
15963182032985465580ULL,
15992499193042326083ULL,
16021547660063149268ULL,
16050328817194402490ULL,
16078844054812462115ULL,
16107094770301238254ULL,
16135082367830800136ULL,
16162808258137064492ULL,
16190273858302528490ULL,
16217480591538125760ULL,
16244429886966205545ULL,
16271123179404678851ULL,
16297561909152347799ULL,
16323747521775473622ULL,
16349681467895574080ULL,
16375365202978508054ULL,
16400800187124865804ULL,
16425987884861683399ULL,
16450929764935515951ULL,
16475627300106897417ULL,
16500081966946196187ULL,
16524295245630914998ULL,
16548268619744432867ULL,
16572003576076237569ULL,
16595501604423648647ULL,
16618764197395067955ULL,
16641792850214778511ULL,
16664589060529296284ULL,
16687154328215321150ULL,
16709490155189286992ULL,
16731598045218541009ULL,
16753479503734156840ULL,
16775136037645418485ULL,
16796569155155984268ULL,
16817780365581740075ULL,
16838771179170378865ULL,
16859543106922685617ULL,
16880097660415594781ULL,
16900436351626990136ULL,
16920560692762272523ULL,
16940472196082739330ULL,
16960172373735736450ULL,
16979662737586638188ULL,
16998944799052657406ULL,
17018020068938481305ULL,
17036890057273753621ULL,
17055556273152433300ULL,
17074020224573999592ULL,
17092283418286547480ULL,
17110347359631764196ULL,
17128213552391819184ULL,
17145883498638121279ULL,
17163358698582019380ULL,
17180640650427416560ULL,
17197730850225279125ULL,
17214630791730114592ULL,
17231341966258367714ULL,
17247865862548746137ULL,
17264203966624501092ULL,
17280357761657665429ULL,
17296328727835228217ULL,
17312118342227268989ULL,
17327728078657051659ULL,
17343159407573082720ULL,
17358413795923108296ULL,
17373492707030107838ULL,
17388397600470222059ULL,
17403129931952654393ULL,
17417691153201536736ULL,
17432082711839750228ULL,
17446306051274721871ULL,
17460362610586157700ULL,
17474253824415756409ULL,
17487981122858864153ULL,
17501545931358082080ULL,
17514949670598835829ULL,
17528193756406870030ULL,
17541279599647704772ULL,
17554208606128017070ULL,
17566982176498958882ULL,
17579601706161397814ULL,
17592068585173094373ULL,
17604384198157776489ULL,
17616549924216129787ULL,
17628567136838705928ULL,
17640437203820709721ULL,
17652161487178678887ULL,
17663741343069047219ULL,
17675178121708593449ULL,
17686473167296729618ULL,
17697627817939679770ULL,
17708643405576463481ULL,
17719521255906776645ULL,
17730262688320637818ULL,
17740869015829906391ULL,
17751341545001580183ULL,
17761681575892909417ULL,
17771890401988280853ULL,
17781969310137911380ULL,
17791919580498265551ULL,
17801742486474271018ULL,
17811439294663250973ULL,
17821011264800599032ULL,
17830459649707171127ULL,
17839785695238392104ULL,
17848990640235042360ULL,
17858075716475743003ULL,
17867042148631111814ULL,
17875891154219550714ULL,
17884623943564710959ULL,
17893241719754555185ULL,
17901745678602062515ULL,
17910137008607521266ULL,
17918416890922404643ULL,
17926586499314840962ULL,
17934647000136611395ULL,
17942599552291723760ULL,
17950445307206490724ULL,
17958185408801147075ULL,
17965820993462941367ULL,
17973353190020731964ULL,
17980783119721036666ULL,
17988111896205556693ULL,
17995340625490117267ULL,
18002470405945040961ULL,
18009502328276930718ULL,
18016437475511841723ULL,
18023276922979821346ULL,
18030021738300824082ULL,
18036672981371952959ULL,
18043231704356032032ULL,
18049698951671507669ULL,
18056075759983609268ULL,
18062363158196824912ULL,
18068562167448606411ULL,
18074673801104347679ULL,
18080699064753569402ULL,
18086638956207328492ULL,
18092494465496815366ULL,
18098266574873139024ULL,
18103956258808258353ULL,
18109564483997082751ULL,
18115092209360672757ULL,
18120540386050575333ULL,
18125909957454245286ULL,
18131201859201536641ULL,
18136417019172277844ULL,
18141556357504870693ULL,
18146620786605917632ULL,
18151611211160886653ULL,
18156528528145732914ULL,
18161373626839527918ULL,
18166147388838031551ULL,
18170850688068227771ULL,
18175484390803766182ULL,
18180049355681327968ULL,
18184546433717890786ULL,
18188976468328860245ULL,
18193340295347072604ULL,
18197638743042638653ULL,
18201872632143621822ULL,
18206042775857518195ULL,
18210149979893549953ULL,
18214195042485730679ULL,
18218178754416686320ULL,
18222101899042248010ULL,
18225965252316754334ULL,
18229769582819081537ULL,
18233515651779378569ULL,
18237204213106481527ULL,
18240836013415995971ULL,
18244411792059040143ULL,
18247932281151630642ULL,
18251398205604668923ULL,
18254810283154574863ULL,
18258169224394474940ULL,
18261475732805998193ULL,
18264730504791610623ULL,
18267934229707525007ULL,
18271087589897126056ULL,
18274191260724910906ULL,
18277245910610958806ULL,
18280252201065862994ULL,
18283210786726166354ULL,
18286122315390231520ULL,
18288987428054575485ULL,
18291806758950645587ULL,
18294580935581997600ULL,
18297310578761887478ULL,
18299996302651267509ULL,
18302638714797152220ULL,
18305238416171344782ULL,
18307796001209533163ULL,
18310312057850714435ULL,
18312787167576956470ULL,
18315221905453464680ULL,
18317616840168960735ULL,
18319972534076340893ULL,
18322289543233632452ULL,
18324568417445185902ULL,
18326809700303144397ULL,
18329013929229153561ULL,
18331181635516286204ULL,
18333313344371193518ULL,
18335409574956475800ULL,
18337470840433231124ULL,
18339497648003793504ULL,
18341490498954644378ULL,
18343449888699499723ULL,
18345376306822519642ULL,
18347270237121702836ULL,
18349132157652359637ULL,
18350962540770749121ULL,
18352761853177808659ULL,
18354530555962982835ULL,
18356269104648144801ULL,
18357977949231596204ULL,
18359657534232154929ULL,
18361308298733275194ULL,
18362930676427248524ULL,
18364525095659430153ULL,
18366091979472502391ULL,
18367631745650786531ULL,
18369144806764524701ULL,
18370631570214217191ULL,
18372092438274943597ULL,
18373527808140658545ULL,
18374938071968494346ULL,
18376323616923035929ULL,
18377684825220549541ULL,
18379022074173183732ULL,
18380335736233131041ULL,
18381626179036713428ULL,
18382893765448416866ULL,
18384138853604868159ULL,
18385361796958717010ULL,
18386562944322448767ULL,
18387742639912097790ULL,
18388901223390877636ULL,
18390039029912695692ULL,
18391156390165568436ULL,
18392253630414921157ULL,
18393331072546760575ULL,
18394389034110729595ULL,
18395427828363018797ULL,
18396447764309162369ULL,
18397449146746656107ULL,
18398432276307459862ULL,
18399397449500331295ULL,
18400344958753000177ULL,
18401275092454178614ULL,
18402188134995414125ULL,
18403084366812750922ULL,
18403964064428227110ULL,
18404827500491189318ULL,
18405674943819410917ULL,
18406506659440032281ULL,
18407322908630293076ULL,
18408123948958077361ULL,
18408910034322250702ULL,
18409681414992793935ULL,
18410438337650712758ULL,
18411181045427762458ULL,
18411909777945923055ULL,
18412624771356684951ULL,
18413326258380084999ULL,
18414014468343539214ULL,
18414689627220421278ULL,
18415351957668430752ULL,
18416001679067725581ULL,
18416639007558793455ULL,
18417264156080117506ULL,
18417877334405569312ULL,
18418478749181570807ULL,
18419068603964022796ULL,
18419647099254946910ULL,
18420214432538917264ULL,
18420770798319221749ULL,
18421316388153757552ULL,
18421851390690686357ULL,
18422375991703830708ULL,
18422890374127800006ULL,
18423394718092862297ULL,
18423889200959545689ULL,
18424373997352999423ULL,
18424849279197056846ULL,
18425315215748053425ULL,
18425771973628374372ULL,
18426219716859722665ULL,
18426658606896139783ULL,
18427088802656730661ULL,
18427510460558136736ULL,
18427923734546731698ULL,
18428328776130539925ULL,
18428725734410893776ULL,
18429114756113802037ULL,
18429495985621059523ULL,
18429869565001084010ULL,
18430235634039455042ULL,
18430594330269212419ULL,
18430945789000856559ULL,
18431290143352085428ULL,
18431627524277249533ULL,
18431958060596534226ULL,
18432281879024890115ULL,
18432599104200642266ULL,
18432909858713868304ULL,
18433214263134492273ULL,
18433512436040091944ULL,
18433804494043449611ULL,
18434090551819818638ULL,
18434370722133928883ULL,
18434645115866717110ULL,
18434913842041777788ULL,
18435177007851564307ULL,
18435434718683296709ULL,
18435687078144622151ULL,
18435934188088995740ULL,
18436176148640802557ULL,
18436413058220200047ULL,
18436645013567715462ULL,
18436872109768563673ULL,
18437094440276706167ULL,
18437312096938648906ULL,
18437525170016988296ULL,
18437733748213677534ULL,
18437937918693048000ULL,
18438137767104581067ULL,
18438333377605397981ULL,
18438524832882523268ULL,
18438712214174877762ULL,
18438895601295019753ULL,
18439075072650648095ULL,
18439250705265828015ULL,
18439422574802011245ULL,
18439590755578764981ULL,
18439755320594283610ULL,
18439916341545648554ULL,
18440073888848843149ULL,
18440228031658534131ULL,
18440378837887596595ULL,
18440526374226426366ULL,
18440670706161986600ULL,
18440811897996655656ULL,
18440950012866804585ULL,
18441085112761166635ULL,
18441217258538971048ULL,
18441346509947843447ULL,
18441472925641493626ULL,
18441596563197153753ULL,
18441717479132824769ULL,
18441835728924270901ULL,
18441951367021815433ULL,
18442064446866916932ULL,
18442175020908509777ULL,
18442283140619159796ULL,
18442388856510974958ULL,
18442492218151338122ULL,
18442593274178397130ULL,
18442692072316379287ULL,
18442788659390677041ULL,
18442883081342734941ULL,
18442975383244744774ULL,
18443065609314125798ULL,
18443153802927820093ULL,
18443240006636377626ULL,
18443324262177861055ULL,
18443406610491542556ULL,
18443487091731422711ULL,
18443565745279548342ULL,
18443642609759154712ULL,
18443717723047611309ULL,
18443791122289187365ULL,
18443862843907641753ULL,
18443932923618616454ULL,
18444001396441875195ULL,
18444068296713341028ULL,
18444133658096972155ULL,
18444197513596466740ULL,
18444259895566792090ULL,
18444320835725538209ULL,
18444380365164116518ULL,
18444438514358782948ULL,
18444495313181503885ULL,
18444550790910655734ULL,
18444604976241555784ULL,
18444657897296859040ULL,
18444709581636770179ULL,
18444760056269116854ULL,
18444809347659265854ULL,
18444857481739884430ULL,
18444904483920553729ULL,
18444950379097241253ULL,
18444995191661616183ULL,
18445038945510216798ULL,
18445081664053493107ULL,
18445123370224692342ULL,
18445164086488610409ULL,
18445203834850202383ULL,
18445242636863063584ULL,
18445280513637767375ULL,
18445317485850068938ULL,
18445353573749000418ULL,
18445388797164802014ULL,
18445423175516746745ULL,
18445456727820838134ULL,
18445489472697371537ULL,
18445521428378384551ULL,
18445552612714984941ULL,
18445583043184544541ULL,
18445612736897789153ULL,
18445641710605775217ULL,
18445669980706723207ULL,
18445697563252779379ULL,
18445724473956620384ULL,
18445750728197995487ULL,
18445776341030100081ULL,
18445801327185902990ULL,
18445825701084328183ULL,
18445849476836337111ULL,
18445872668250914000ULL,
18445895288840960999ULL,
18445917351829054694ULL,
18445938870153151762ULL,
18445959856472155981ULL,
18445980323171411291ULL,
18446000282368100103ULL,
18446019745916528370ULL,
18446038725413341341ULL,
18446057232202637625ULL,
18446075277380990822ULL,
18446092871802383336ULL,
18446110026083068556ULL,
18446126750606315172ULL,
18446143055527102969ULL,
18446158950776712312ULL,
18446174446067228131ULL,
18446189550895990757ULL,
18446204274549926581ULL,
18446218626109846373ULL,
18446232614454618798ULL,
18446246248265309282ULL,
18446259536029207938ULL,
18446272486043825154ULL,
18446285106420762384ULL,
18446297405089559827ULL,
18446309389801449367ULL,
18446321068133033554ULL,
18446332447489922996ULL,
18446343535110262823ULL,
18446354338068242973ULL,
18446364863277506804ULL,
18446375117494508859ULL,
18446385107321810237ULL,
18446394839211313885ULL,
18446404319467423625ULL,
18446413554250170830ULL,
18446422549578257906ULL,
18446431311332048622ULL,
18446439845256507602ULL,
18446448156964088977ULL,
18446456251937544150ULL,
18446464135532713392ULL,
18446471812981220374ULL,
18446479289393152831ULL,
18446486569759669287ULL,
18446493658955571105ULL,
18446500561741793659ULL,
18446507282767892889ULL,
18446513826574439409ULL,
18446520197595408002ULL,
18446526400160472366ULL,
18446532438497304475ULL,
18446538316733786133ULL,
18446544038900206660ULL,
18446549608931400490ULL,
18446555030668843181ULL,
18446560307862712751ULL,
18446565444173904807ULL,
18446570443176008374ULL,
18446575308357240142ULL,
18446580043122344039ULL,
18446584650794449215ULL,
18446589134616879486ULL,
18446593497754955862ULL,
18446597743297729726ULL,
18446601874259697547ULL,
18446605893582480912ULL,
18446609804136458041ULL,
18446613608722381428ULL,
18446617310072951579ULL,
18446620910854360708ULL,
18446624413667792523ULL,
18446627821050903527ULL,
18446631135479285828ULL,
18446634359367867561ULL,
18446637495072306372ULL,
18446640544890355169ULL,
18446643511063172418ULL,
18446646395776655541ULL,
18446649201162681882ULL,
18446651929300379712ULL,
18446654582217341465ULL,
18446657161890813860ULL,
18446659670248876468ULL,
18446662109171585624ULL,
18446664480492081351ULL,
18446666785997698920ULL,
18446669027431036488ULL,
18446671206490999638ULL,
18446673324833832051ULL,
18446675384074116130ULL,
18446677385785764390ULL,
18446679331502969241ULL,
18446681222721145850ULL,
18446683060897861123ULL,
18446684847453718797ULL,
18446686583773246826ULL,
18446688271205761666ULL,
18446689911066195590ULL,
18446691504635940168ULL,
18446693053163625051ULL,
18446694557865931412ULL,
18446696019928336065ULL,
18446697440505878690ULL,
18446698820723899016ULL,
18446700161678739341ULL,
18446701464438467850ULL,
18446702730043548782ULL,
18446703959507514909ULL,
18446705153817637702ULL,
18446706313935553590ULL,
18446707440797894842ULL,
18446708535316908893ULL,
18446709598381045319ULL,
18446710630855549743ULL,
18446711633583030010ULL,
18446712607384015430ULL,
18446713553057504468ULL,
18446714471381498563ULL,
18446715363113517466ULL,
18446716228991112263ULL,
18446717069732362226ULL,
18446717886036355480ULL,
18446718678583669676ULL,
18446719448036829556ULL,
18446720195040766821ULL,
18446720920223249969ULL,
18446721624195321051ULL,
18446722307551723199ULL,
18446722970871305032ULL,
18446723614717420446ULL,
18446724239638328405ULL,
18446724846167567310ULL,
18446725434824333988ULL,
18446726006113846508ULL,
18446726560527697752ULL,
18446727098544213605ULL,
18446727620628781112ULL,
18446728127234178933ULL,
18446728618800914738ULL,
18446729095757521012ULL,
18446729558520880884ULL,
18446730007496514691ULL,
18446730443078880392ULL,
18446730865651664743ULL,
18446731275588049060ULL,
18446731673250991142ULL,
18446732058993491034ULL,
18446732433158842915ULL,
18446732796080898540ULL,
18446733148084307582ULL,
18446733489484751029ULL,
18446733820589195388ULL,
18446734141696107600ULL,
18446734453095674580ULL,
18446734755070034305ULL,
18446735047893479175ULL,
18446735331832668623ULL,
18446735607146818605ULL,
18446735874087921139ULL,
18446736132900913005ULL,
18446736383823879100ULL,
18446736627088225763ULL,
18446736862918863336ULL,
18446737091534377171ULL,
18446737313147196325ULL,
18446737527963769196ULL,
18446737736184702174ULL,
18446737938004939893ULL,
18446738133613899266ULL,
18446738323195635869ULL,
18446738506928968734ULL,
18446738684987637488ULL,
18446738857540434078ULL,
18446739024751339114ULL,
18446739186779648970ULL,
18446739343780109818ULL,
18446739495903028551ULL,
18446739643294413751ULL,
18446739786096072745ULL,
18446739924445741020ULL,
18446740058477186209ULL,
18446740188320321333ULL,
18446740314101306476ULL,
18446740435942657402ULL,
18446740553963344921ULL,
18446740668278885018ULL,
18446740779001449777ULL,
18446740886239939015ULL,
18446740990100095836ULL,
18446741090684571328ULL,
18446741188093026252ULL,
18446741282422209605ULL,
18446741373766037200ULL,
18446741462215667917ULL,
18446741547859598459ULL,
18446741630783711877ULL,
18446741711071374628ULL,
18446741788803492041ULL,
18446741864058584574ULL,
18446741936912854831ULL,
18446742007440247648ULL,
18446742075712521728ULL,
18446742141799302797ULL,
18446742205768155239ULL,
18446742267684632935ULL,
18446742327612332420ULL,
18446742385612964516ULL,
18446742441746384374ULL,
18446742496070672361ULL,
18446742548642159475ULL,
18446742599515494366ULL,
18446742648743682618ULL,
18446742696378139901ULL,
18446742742468733571ULL,
18446742787063828882ULL,
18446742830210330589ULL,
18446742871953729163ULL,
18446742912338137766ULL,
18446742951406336158ULL,
18446742989199803052ULL,
18446743025758760021ULL,
18446743061122206158ULL,
18446743095327950436ULL,
18446743128412655608ULL,
18446743160411859010ULL,
18446743191360016468ULL,
18446743221290527715ULL,
18446743250235771060ULL,
18446743278227126492ULL,
18446743305295014970ULL,
18446743331468926149ULL,
18446743356777432253ULL,
18446743381248227352ULL,
18446743404908152789ULL,
18446743427783222595ULL,
18446743449898641981ULL,
18446743471278837378ULL,
18446743491947472611ULL,
18446743511927481256ULL,
18446743531241085125ULL,
18446743549909808131ULL,
18446743567954506333ULL,
18446743585395384108ULL,
18446743602252014954ULL,
18446743618543359974ULL,
18446743634287784052ULL,
18446743649503078967ULL,
18446743664206477252ULL,
18446743678414663754ULL,
18446743692143805673ULL,
18446743705409554874ULL,
18446743718227073306ULL,
18446743730611042247ULL,
18446743742575673860ULL,
18446743754134738918ULL,
18446743765301559880ULL,
18446743776089047858ULL,
18446743786509695688ULL,
18446743796575601040ULL,
18446743806298475659ULL,
18446743815689659232ULL,
18446743824760121698ULL,
18446743833520493293ULL,
18446743841981055301ULL,
18446743850151760857ULL,
18446743858042244189ULL,
18446743865661829862ULL,
18446743873019546642ULL,
18446743880124122875ULL,
18446743886984014221ULL,
18446743893607396715ULL,
18446743900002187572ULL,
18446743906176040560ULL,
18446743912136366802ULL,
18446743917890337084ULL,
18446743923444888789ULL,
18446743928806728209ULL,
18446743933982349031ULL,
18446743938978032336ULL,
18446743943799848913ULL,
18446743948453682365ULL,
18446743952945210624ULL,
18446743957279935993ULL,
18446743961463173588ULL,
18446743965500062896ULL,
18446743969395583951ULL,
18446743973154541158ULL,
18446743976781586398ULL,
18446743980281221346ULL,
18446743983657792843ULL,
18446743986915504452ULL,
18446743990058425707ULL,
18446743993090487481ULL,
18446743996015486618ULL,
18446743998837099792ULL,
18446744001558881199ULL,
18446744004184260245ULL,
18446744006716560033ULL,
18446744009158988122ULL,
18446744011514645767ULL,
18446744013786530232ULL,
18446744015977537099ULL,
18446744018090467206ULL,
18446744020128026639ULL,
18446744022092831361ULL,
18446744023987407208ULL,
18446744025814196823ULL,
18446744027575557345ULL,
18446744029273769653ULL,
18446744030911036053ULL,
18446744032489484904ULL,
18446744034011172924ULL,
18446744035478085196ULL,
18446744036892139781ULL,
18446744038255190040ULL,
18446744039569029246ULL,
18446744040835381346ULL,
18446744042055924068ULL,
18446744043232263502ULL,
18446744044365964141ULL,
18446744045458525773ULL,
18446744046511404278ULL,
18446744047526002384ULL,
18446744048503674291ULL,
18446744049445730290ULL,
18446744050353432145ULL,
18446744051228002332ULL,
18446744052070614799ULL,
18446744052882408830ULL,
18446744053664482112ULL,
18446744054417893046ULL,
18446744055143667682ULL,
18446744055842795093ULL,
18446744056516222757ULL,
18446744057164872730ULL,
18446744057789637030ULL,
18446744058391368384ULL,
18446744058970898725ULL,
18446744059529020697ULL,
18446744060066508461ULL,
18446744060584103820ULL,
18446744061082525472ULL,
18446744061562466692ULL,
18446744062024593026ULL,
18446744062469549220ULL,
18446744062897959223ULL,
18446744063310421564ULL,
18446744063707516283ULL,
18446744064089798002ULL,
18446744064457812097ULL,
18446744064812069282ULL,
18446744065153077959ULL,
18446744065481316490ULL,
18446744065797253991ULL,
18446744066101338781ULL,
18446744066394007623ULL,
18446744066675674172ULL,
18446744066946745151ULL,
18446744067207608793ULL,
18446744067458637158ULL,
18446744067700193060ULL,
18446744067932627758ULL,
18446744068156276336ULL,
18446744068371460013ULL,
18446744068578495383ULL,
18446744068777682868ULL,
18446744068969309020ULL,
18446744069153658084ULL,
18446744069331000437ULL,
18446744069501592591ULL,
18446744069665686436ULL,
18446744069823524620ULL,
18446744069975340544ULL,
18446744070121353747ULL,
18446744070261786077ULL,
18446744070396840895ULL,
18446744070526726183ULL,
18446744070651629127ULL,
18446744070771739222ULL,
18446744070887234409ULL,
18446744070998288006ULL,
18446744071105068711ULL,
18446744071207735978ULL,
18446744071306442326ULL,
18446744071401340278ULL,
18446744071492573110ULL,
18446744071580277166ULL,
18446744071664586480ULL,
18446744071745628152ULL,
18446744071823529283ULL,
18446744071898405419ULL,
18446744071970374418ULL,
18446744072039544891ULL,
18446744072106023142ULL,
18446744072169913162ULL,
18446744072231309699ULL,
18446744072290309811ULL,
18446744072347005935ULL,
18446744072401485887ULL,
18446744072453832859ULL,
18446744072504127733ULL,
18446744072552451393ULL,
18446744072598877786ULL,
18446744072643483174ULL,
18446744072686332263ULL,
18446744072727494379ULL,
18446744072767036541ULL,
18446744072805018831ULL,
18446744072841503644ULL,
18446744072876546443ULL,
18446744072910205001ULL,
18446744072942530157ULL,
18446744072973577374ULL,
18446744073003390560ULL,
18446744073032022866ULL,
18446744073059518198ULL,
18446744073085920465ULL,
18446744073111273574ULL,
18446744073135616811ULL,
18446744073158989462ULL,
18446744073181428500ULL,
18446744073202973212ULL,
18446744073223655951ULL,
18446744073243511380ULL,
18446744073262571853ULL,
18446744073280867411ULL,
18446744073298430407ULL,
18446744073315288572ULL,
18446744073331469638ULL,
18446744073346999024ULL,
18446744073361904461ULL,
18446744073376209059ULL,
18446744073389938238ULL,
18446744073403110485ULL,
18446744073415751220ULL,
18446744073427881242ULL,
18446744073439519038ULL,
18446744073450687717ULL,
18446744073461401145ULL,
18446744073471682430ULL,
18446744073481545439ULL,
18446744073491006348ULL,
18446744073500081332ULL,
18446744073508788881ULL,
18446744073517140548ULL,
18446744073525152509ULL,
18446744073532836320ULL,
18446744073540208157ULL,
18446744073547274952ULL,
18446744073554055192ULL,
18446744073560558123ULL,
18446744073566795297ULL,
18446744073572773649ULL,
18446744073578507043ULL,
18446744073584004723ULL,
18446744073589275932ULL,
18446744073594332226ULL,
18446744073599178227ULL,
18446744073603825488ULL,
18446744073608280943ULL,
18446744073612549213ULL,
18446744073616641853ULL,
18446744073620568107ULL,
18446744073624330286ULL,
18446744073627933011ULL,
18446744073631390148ULL,
18446744073634704008ULL,
18446744073637876902ULL,
18446744073640918074ULL,
18446744073643834455ULL,
18446744073646628358ULL,
18446744073649306715ULL,
18446744073651871837ULL,
18446744073654328345ULL,
18446744073656685484ULL,
18446744073658940943ULL,
18446744073661101653ULL,
18446744073663174549ULL,
18446744073665159630ULL,
18446744073667061518ULL,
18446744073668882523ULL,
18446744073670624957ULL,
18446744073672295753ULL,
18446744073673897220ULL,
18446744073675431672ULL,
18446744073676899106ULL,
18446744073678306457ULL,
18446744073679651413ULL,
18446744073680940906ULL,
18446744073682177249ULL,
18446744073683360440ULL,
18446744073684492791ULL,
18446744073685576613ULL,
18446744073686614216ULL,
18446744073687607912ULL,
18446744073688560011ULL,
18446744073689470514ULL,
18446744073690344042ULL,
18446744073691180595ULL,
18446744073691980174ULL,
18446744073692745088ULL,
18446744073693477650ULL,
18446744073694177859ULL,
18446744073694850337ULL,
18446744073695492773ULL,
18446744073696105167ULL,
18446744073696694452ULL,
18446744073697258316ULL,
18446744073697796761ULL,
18446744073698314407ULL,
18446744073698806633ULL,
18446744073699280372ULL,
18446744073699731001ULL,
18446744073700165454ULL,
18446744073700576798ULL,
18446744073700974276ULL,
18446744073701350956ULL,
18446744073701711460ULL,
18446744073702058098ULL,
18446744073702388560ULL,
18446744073702705156ULL,
18446744073703010197ULL,
18446744073703299062ULL,
18446744073703576373ULL,
18446744073703842129ULL,
18446744073704094019ULL,
18446744073704336666ULL,
18446744073704567758ULL,
18446744073704791917ULL,
18446744073705002211ULL,
18446744073705203261ULL,
18446744073705397378ULL,
18446744073705582252ULL,
18446744073705760193ULL,
18446744073705928890ULL,
18446744073706090654ULL,
18446744073706245486ULL,
18446744073706393385ULL,
18446744073706534351ULL,
18446744073706670695ULL,
18446744073706800107ULL,
18446744073706922586ULL,
18446744073707040443ULL,
18446744073707153678ULL,
18446744073707262291ULL,
18446744073707363972ULL,
18446744073707461030ULL,
18446744073707558089ULL,
18446744073707648215ULL,
18446744073707733719ULL,
18446744073707814601ULL,
18446744073707893172ULL,
18446744073707967122ULL,
18446744073708038760ULL,
18446744073708105777ULL,
18446744073708170483ULL,
18446744073708232878ULL,
18446744073708292962ULL,
18446744073708350735ULL,
18446744073708403886ULL,
18446744073708454726ULL,
18446744073708505566ULL,
18446744073708551785ULL,
18446744073708598003ULL,
18446744073708641911ULL,
18446744073708683507ULL,
18446744073708722793ULL,
18446744073708759768ULL,
18446744073708794431ULL,
18446744073708829095ULL,
18446744073708861448ULL,
18446744073708891490ULL,
18446744073708921532ULL,
18446744073708949263ULL,
18446744073708976994ULL,
18446744073709002414ULL,
18446744073709027834ULL,
18446744073709050944ULL,
18446744073709074053ULL,
18446744073709094851ULL,
18446744073709115649ULL,
18446744073709134137ULL,
18446744073709152624ULL,
18446744073709171112ULL,
18446744073709187288ULL,
18446744073709203464ULL,
18446744073709219641ULL,
18446744073709233506ULL,
18446744073709247372ULL,
18446744073709261237ULL,
18446744073709275103ULL,
18446744073709286658ULL,
18446744073709298212ULL,
18446744073709309767ULL,
18446744073709321321ULL,
18446744073709330565ULL,
18446744073709339809ULL,
18446744073709349052ULL,
18446744073709358296ULL,
18446744073709367540ULL,
18446744073709374473ULL,
18446744073709381405ULL,
18446744073709388338ULL,
18446744073709395271ULL,
18446744073709402204ULL,
18446744073709411447ULL,
18446744073709418380ULL,
18446744073709423002ULL,
18446744073709427624ULL,
18446744073709432246ULL,
18446744073709436867ULL,
18446744073709441489ULL,
18446744073709446111ULL,
18446744073709450733ULL,
18446744073709455355ULL,
18446744073709459977ULL,
18446744073709464598ULL,
18446744073709469220ULL,
18446744073709471531ULL,
18446744073709473842ULL,
18446744073709476153ULL,
18446744073709478464ULL,
18446744073709480775ULL,
18446744073709483086ULL,
18446744073709485397ULL,
18446744073709487708ULL,
18446744073709490019ULL,
18446744073709492329ULL,
18446744073709494640ULL,
18446744073709496951ULL,
18446744073709499262ULL,
18446744073709501573ULL,
18446744073709503884ULL,
18446744073709506195ULL,
18446744073709508506ULL,
18446744073709510817ULL,
18446744073709513128ULL,
18446744073709515439ULL,
18446744073709517750ULL,
18446744073709520061ULL,
18446744073709522371ULL,
18446744073709551615ULL
};

int32_t Gandalf_Gaussian_sampler(){

    uint64_t zero_mask, neg_mask, r;
    int32_t z;

    zero_mask = get64();
    // when zero_mask = -1,
    //     neg_mask = 0 if we return a positive value
    //     neg_mask = -1 if we return a negative value
    neg_mask = -(zero_mask >> 63);

    // zero_mask = 0 if we return 0
    // zero_mask = -1 if we return a non-zero value
    zero_mask &= (1ULL << 63) - 1;
    zero_mask = ((zero_mask - Gandalf_table[0]) >> 63) & 1;
    zero_mask = ~(-zero_mask);

    r = get64();

    z = 1;
    for(size_t i = 1; i < GANDALF_TABLE_SIZE; i++){
        z += (r >= Gandalf_table[i]);
    }

    z = ( z & (~neg_mask) ) | ( (-z) & (neg_mask) );

    return zero_mask & z;

}

void Gandalf_sample_poly(poly *u){
    for(size_t i = 0; i < N; i++){
        u->coeffs[i] = Gandalf_Gaussian_sampler();
    }
}

